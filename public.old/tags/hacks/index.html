<!doctype html><html lang=en><title>Hacks :: end.re</title><link href=https://end.re/tags/hacks/index.xml rel=alternate type=application/rss+xml title=end.re><link rel="shortcut icon" href=/favicon.png><link href=/a/s.css media=screen rel=stylesheet><link href=http://gmpg.org/xfn/11 rel=profile><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png href=/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/favicon-16x16.png sizes=16x16><link rel=manifest href=/manifest.json><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><meta name=theme-color content=#fafafa><meta property=og:title content=Hacks><meta property=og:description content="yet another tech blog with underdeveloped thoughts, quick and dirty tips and tricks, random ramblings"><meta property=og:type content=website><meta property=og:locale content=en_US><meta property=og:url content=https://end.re/tags/hacks/><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta name=description content="yet another tech blog with underdeveloped thoughts, quick and dirty tips and tricks, random ramblings"><meta name=keywords content><meta name=author content="Endre Szabo"><meta name=generator content="Hugo 0.40.2"><header class=header-main><div class=logo><a title=end.re href=https://end.re><img src=/images/el.svg alt=logo width=90 class=logo-main></a></div><div class=nav><nav class=main-nav><ul><li><a href=/blog/>Blog</a><li><a href=/tutorial/>Tutorials</a><li><a href=/about/>About</a></ul></nav></div></header><main class=wrapper-main><section class=wrapper-content><h1 class=h1-title>Entries tagged with <span class=tag-Hacks>#Hacks</span></h1><div class=post-index><article class=post-content><h2 class=post-title><a href=/2018/06/12/ebp040_defeating-checkpoint-route-all-traffic-enforcement/>Defeating CheckPoint VPN Route-All-Traffic Policy Enforcement</a></h2><span class=a-meta><a class=category-proof-of-concept href=/categories/proof-of-concept/>Proof of Concept</a></span>
<span class=m-split><a class=tag-firewall href=/tags/firewall/>#firewall</a>,
<a class=tag-vpn href=/tags/vpn/>#vpn</a>,
<a class=tag-hacks href=/tags/hacks/>#hacks</a></span>
<time class=m-split datetime=2018-06-12T07:20:30&#43;00:00>Jun 12th, 2018</time><div class=entry-content><p>Quite a bit of the enterprises have chosen to use CheckPoint VPN solutions to allow remote access to their corporate networks. This platform is widely used and it&rsquo;s up to the security administrators to create the actual VPN security policies that apply to the connecting clients. Among these security rules, it&rsquo;s very common to enforce all of the client&rsquo;s traffic to go through the tunnel, be it destined to the corporate office or not, like Internet traffic that the corporation has noting to with. There is even a knowledge base entry on how to set up to <a href="https://supportcenter.checkpoint.com/supportcenter/portal?eventSubmit_doGoviewsolutiondetails=&amp;solutionid=sk101239" target=_blank>Route all traffic from Remote Access clients, including internet traffic, through Security Gateway</a>. On the sad side effect, when these rules apply, it is also impossible to connect to the VPN client itself from the same subnet the client resides on. And this leads to being unable to do SSH reverse port forwards to access corporate resources from outside of this client. However, this would be really useful in my scenario, where the connecting client is a Windows VM on my ArchLinux host, and I&rsquo;d like to access over-the-tunnel corporate unix hosts using the friendly and very convenient to use OpenSSH <em>from</em> the ArchLinux host and not from the Windows VM using PuTTY or something legacy dumb clients like that.<p>Using a netfilter rule with a trick on the ArchLinux host I managed to make easy to use transparent reverse port forwardings that also &ldquo;complies&rdquo; with the security enforcement rules of the VPN client.</p><a href=/2018/06/12/ebp040_defeating-checkpoint-route-all-traffic-enforcement/ class=more-link>Read more &rarr;</a></div></article><hr></div></section></main><footer id=footer class=inner><a rel=license href=http://creativecommons.org/licenses/by-sa/4.0/><img alt="Creative Commons License" style=border-width:0 src=/images/cc-by-sa-4-0.png></a><br>Website contents at end.re by Endre Szabo are licensed under the <a rel=license href=http://creativecommons.org/licenses/by-sa/4.0/>Creative Commons Attribution-ShareAlike 4.0 International License</a> unless stated otherwise.</footer>