<!doctype html><title>A második SPI busz használata a Raspberry PI 2-n és 3-on :: end.re</title><link href rel=alternate type=application/rss+xml title=end.re><link rel="shortcut icon" href=/favicon.png><link href=/a/s.css media=screen rel=stylesheet><link href=/css/h.css rel=stylesheet><script>const enable_comments=function(){document.getElementById("button_enable_comments").style.display='none';var disqus_config=function(){this.page.url="https://end.re/ebp015/";this.page.identifier="ebp015";};var d=document,s=d.createElement('script');s.src='https://endreszabo.disqus.com/embed.js';s.setAttribute('data-timestamp',+new Date());(d.head||d.body).appendChild(s);}</script><link href=http://gmpg.org/xfn/11 rel=profile><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png href=/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/favicon-16x16.png sizes=16x16><link rel=manifest href=/manifest.json><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><meta name=theme-color content=#fafafa><meta property=og:title content="A második SPI busz használata a Raspberry PI 2-n és 3-on"><meta property=og:description content="yet another tech blog with underdeveloped thoughts, quick and dirty tips and tricks, random ramblings"><meta property=og:type content=website><meta property=og:locale content=en_US><meta property=og:url content=https://end.re/hu/2017/06/24/ebp015_enabling-the-second-spi-bus-on-the-raspberry-pi-2-and-3/><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta name=description content="yet another tech blog with underdeveloped thoughts, quick and dirty tips and tricks, random ramblings"><meta name=keywords content><meta name=author content="Szabó Endre"><meta name=generator content="Hugo 0.40.2"><header class=header-main><div class=logo><a title=end.re href=https://end.re><img src=/images/el.svg alt=logo width=90 class=logo-main></a></div><div class=nav><nav class=main-nav><ul><li><a href=/hu/blog/>Blog</a><li><a href=/hu/tutorial/>Tutorialok</a><li><a href=/rolam/>Rólam</a></ul></nav></div></header><main class=wrapper-main><section class=wrapper-content><section class=post-index itemscope itemtype=http://schema.org/BlogPosting><article class=post-content><div class=post-header><h2 class=post-title itemprop=name>A második SPI busz használata a Raspberry PI 2-n és 3-on</h2><span class=a-meta><a class=category-proof-of-concept href=/hu/kateg%c3%b3ri%c3%a1k/proof-of-concept>Proof of Concept</a>
<span>,</span>
<a class=category-otthonautomatiz%C3%A1l%C3%A1s href=/hu/kateg%c3%b3ri%c3%a1k/otthonautomatiz%C3%A1l%C3%A1s>Otthonautomatizálás</a></span>
<span class=m-split><a class=tag-be%C3%A1gyazott href=/hu/c%c3%admk%c3%a9k/be%C3%A1gyazott>#beágyazott</a></span>
<time class=m-split datetime=2017-06-24T11:58:18&#43;00:00>jún. 24, 2017</time></div><div class="entry-content full-article" itemprop=articleBody><p>Bár kevesen tudják, a Raspberry Pi 2-es szériától kezdve a SoC-on még egy SPI vezérlő kivezetés is helyet kapott. Ez abban segíthet nekünk, hogy egy új slave esetén ne kelljen az SPI0 buszon osztoznia a már meglévő slavenek.<p>A lakásautomatizálási feladatok ellátásának egy részét egy RPI2 végzi itthon. A korábban CAN BUS alapú szenzorhálózatot kiegészítettem a mysensors.org féle NRF24L01 ráadiós adóvevővel rendelkező hálózattal. A CAN BUS controller és transceiver hagyományosan az SPI0 buszon futott, az NRF24L01 került az SPI1-re.<p>A MPC2515 CAN kontroller a kernelben működő drivert használja, egy can0 hálózati eszközt létrehozva.
Az NRF24L01 esetében SPI kommunikációra az spidev stacket használom.<p>/boot/config.txt<div class=highlight><pre class=chroma><code class=language-ini data-lang=ini><span class=na>dtparam</span><span class=o>=</span><span class=s>spi=on</span>

<span class=na>dtoverlay</span><span class=o>=</span><span class=s>spi-dma</span>
<span class=na>dtoverlay</span><span class=o>=</span><span class=s>spi-bcm2835</span>
<span class=na>dtoverlay</span><span class=o>=</span><span class=s>mcp2515-can0,oscillator=8000000,interrupt=25</span>
<span class=na>dtoverlay</span><span class=o>=</span><span class=s>spi1-1cs</span></code></pre></div></div></article></section><hr><section id=comments><h2 class=title>Számít a véleményed. Oszd meg!</h2><button id=button_enable_comments class=comments-toggle onclick=enable_comments();>Click to show comments</button><div id=disqus_thread aria-live=polite><noscript><p>Tiszteletben tartom a privát szférád. Éppen ezért általánosságban az oldal működéséhez égyáltalán nem szükséges JavaScript. A komment szekció azonban kivétel ez alól, mert a kommentelési lehetőséget (lévén ez az oldal maga egy statikusan generált oldal) egy külső szolgáltató, <a href=http://disqus.com/?ref_noscript>Disqus biztosítja</a>.</p></noscript></div></section></section></section><footer id=footer class=inner><a rel=license href=http://creativecommons.org/licenses/by-sa/4.0/><img alt="Creative Commons License" style=border-width:0 src=/images/cc-by-sa-4-0.png></a><br>Eltérő rendelkezés hiányában Szabó Endre a <a rel=license href=http://creativecommons.org/licenses/by-sa/4.0/>Creative Commons Attribution-ShareAlike 4.0 International License</a>-szel licenceli az end.re weboldalon található tartalmait.</footer><script src=/js/highlight.js></script><script>hljs.initHighlightingOnLoad();</script></main>